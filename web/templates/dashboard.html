{{define "content"}}
{{if .Error}}
<div class="error" style="background-color: #f8d7da; color: #721c24; padding: 1rem; border: 1px solid #f5c6cb; border-radius: .25rem; margin-bottom: 1rem;">
    {{.Error}}
</div>
{{end}}
<div class="dashboard-grid">
    <div class="metric-card">
        <h3>Pass Rate</h3>
        <div class="stat">{{.PassRate}}%</div>
        <div class="trend {{if gt .PassRateTrend "0"}}up{{else}}down{{end}}">
            {{.PassRateTrend}}
        </div>
        <div class="chart">
            {{.PassRateChart}}
        </div>
    </div>

    <div class="metric-card">
        <h3>Avg Duration</h3>
        <div class="stat">{{.AvgDuration}}</div>
        <div class="trend {{if lt .DurationTrend "0"}}up{{else}}down{{end}}">
            {{.DurationTrend}}
        </div>
        <div class="chart">
            {{.DurationChart}}
        </div>
    </div>

    <div class="metric-card">
        <h3>Total Tests</h3>
        <div class="stat">{{.TotalTests}}</div>
    </div>

    <div class="metric-card">
        <h3>Flaky Tests</h3>
        <div class="stat">{{len .FlakyTests}}</div>
    </div>
</div>

<div class="dashboard-sections">
    <div class="section">
        <h2>Recent Failures</h2>
        <table>
            <thead>
                <tr>
                    <th>Execution</th>
                    <th>Workflow</th>
                    <th>Status</th>
                    <th>When</th>
                </tr>
            </thead>
            <tbody>
                {{range .RecentFailures}}
                <tr>
                    <td><a href="/executions/{{.ID}}">{{.Name}}</a></td>
                    <td><a href="/workflows/{{.WorkflowName}}">{{.WorkflowName}}</a></td>
                    <td><span class="status status-{{.Status}}">{{.Status}}</span></td>
                    <td>{{.StartTime.Format "Jan 02 15:04"}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>

    <div class="section">
        <h2>Flaky Tests Alert</h2>
        <div hx-get="/api/v1/flaky-tests" hx-trigger="load">
            Loading...
        </div>
    </div>
</div>
{{end}}
